;$(document).on('orViewLoaded',function(e,o){var a=$(e.target).find('form'),n=$(e.target).find('div.or-dropzone-upload > div.input');n.on('dragenter',function(e){e.stopPropagation();e.preventDefault();$(this).css('border','1px dotted gray')});n.on('dragover',function(e){e.stopPropagation();e.preventDefault()});n.on('drop',function(e){$(this).css('border','1px dotted red');e.preventDefault();var o=e.originalEvent.dataTransfer.files;handleFileUpload(a,o)});$(e.target).find('input[type=file]').change(function(){var e=$(this).prop('files');handleFileUpload(a,e)})});function handleFileUpload(e,n){for(var t=0,r;r=n[t];t++){var o=new FormData();o.append('file',r);o.append('action','folder');o.append('subaction',$(e).data('method'));o.append('output','json');o.append('token',$(e).find('input[name=token]').val());o.append('id',$(e).find('input[name=id]').val());var a=$('<div class="notice info"><div class="text loader"></div></div>');$('#noticebar').prepend(a);$(a).show();$.ajax({'type':'POST',url:'./api/',cache:!1,contentType:!1,processData:!1,data:o,success:function(o,n,t){$(a).remove();let oform=new Openrat.Form();oform.doResponse(o,n,e)},error:function(o,n,d){$(e).closest('div.content').removeClass('loader');$(a).remove();var r;try{var t=jQuery.parseJSON(o.responseText);r=t.error+'/'+t.description+': '+t.reason}catch(i){r=o.responseText};Openrat.Workbench.notify('Upload error',r)}})}};