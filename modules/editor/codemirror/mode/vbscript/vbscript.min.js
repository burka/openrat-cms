(function(e){if(typeof exports=='object'&&typeof module=='object')e(require('../../lib/codemirror'));else if(typeof define=='function'&&define.amd)define(['../../lib/codemirror'],e);else e(CodeMirror)})(function(e){'use strict';e.defineMode('vbscript',function(e,r){var a='error';function t(e){return new RegExp('^(('+e.join(')|(')+'))\\b','i')};var I=new RegExp('^[\\+\\-\\*/&\\\\\\^<>=]'),C=new RegExp('^((<>)|(<=)|(>=))'),L=new RegExp('^[\\.,]'),E=new RegExp('^[\\(\\)]'),D=new RegExp('^[A-Za-z][_A-Za-z0-9]*'),S=['class','sub','select','while','if','function','property','with','for'],T=['else','elseif','case'],O=['next','loop','wend'],j=t(['and','or','not','xor','is','mod','eqv','imp']),F=['dim','redim','then','until','randomize','byval','byref','new','property','exit','in','const','private','public','get','set','let','stop','on error resume next','on error goto 0','option explicit','call','me'],R=['true','false','nothing','empty','null'],z=['abs','array','asc','atn','cbool','cbyte','ccur','cdate','cdbl','chr','cint','clng','cos','csng','cstr','date','dateadd','datediff','datepart','dateserial','datevalue','day','escape','eval','execute','exp','filter','formatcurrency','formatdatetime','formatnumber','formatpercent','getlocale','getobject','getref','hex','hour','inputbox','instr','instrrev','int','fix','isarray','isdate','isempty','isnull','isnumeric','isobject','join','lbound','lcase','left','len','loadpicture','log','ltrim','rtrim','trim','maths','mid','minute','month','monthname','msgbox','now','oct','replace','rgb','right','rnd','round','scriptengine','scriptenginebuildversion','scriptenginemajorversion','scriptengineminorversion','second','setlocale','sgn','sin','space','split','sqr','strcomp','string','strreverse','tan','time','timer','timeserial','timevalue','typename','ubound','ucase','unescape','vartype','weekday','weekdayname','year'],B=['vbBlack','vbRed','vbGreen','vbYellow','vbBlue','vbMagenta','vbCyan','vbWhite','vbBinaryCompare','vbTextCompare','vbSunday','vbMonday','vbTuesday','vbWednesday','vbThursday','vbFriday','vbSaturday','vbUseSystemDayOfWeek','vbFirstJan1','vbFirstFourDays','vbFirstFullWeek','vbGeneralDate','vbLongDate','vbShortDate','vbLongTime','vbShortTime','vbObjectError','vbOKOnly','vbOKCancel','vbAbortRetryIgnore','vbYesNoCancel','vbYesNo','vbRetryCancel','vbCritical','vbQuestion','vbExclamation','vbInformation','vbDefaultButton1','vbDefaultButton2','vbDefaultButton3','vbDefaultButton4','vbApplicationModal','vbSystemModal','vbOK','vbCancel','vbAbort','vbRetry','vbIgnore','vbYes','vbNo','vbCr','VbCrLf','vbFormFeed','vbLf','vbNewLine','vbNullChar','vbNullString','vbTab','vbVerticalTab','vbUseDefault','vbTrue','vbFalse','vbEmpty','vbNull','vbInteger','vbLong','vbSingle','vbDouble','vbCurrency','vbDate','vbString','vbObject','vbError','vbBoolean','vbVariant','vbDataObject','vbDecimal','vbByte','vbArray'],n=['WScript','err','debug','RegExp'],M=['description','firstindex','global','helpcontext','helpfile','ignorecase','length','number','pattern','source','value','count'],A=['clear','execute','raise','replace','test','write','writeline','close','open','state','eof','update','addnew','end','createobject','quit'],N=['server','response','request','session','application'],W=['buffer','cachecontrol','charset','contenttype','expires','expiresabsolute','isclientconnected','pics','status','clientcertificate','cookies','form','querystring','servervariables','totalbytes','contents','staticobjects','codepage','lcid','sessionid','timeout','scripttimeout'],q=['addheader','appendtolog','binarywrite','end','flush','redirect','binaryread','remove','removeall','lock','unlock','abandon','getlasterror','htmlencode','mappath','transfer','urlencode'],i=A.concat(M);n=n.concat(B);if(e.isASP){n=n.concat(N);i=i.concat(q,W)};var v=t(F),f=t(R),m=t(z),p=t(n),h=t(i),y='"',g=t(S),u=t(T),s=t(O),l=t(['end']),x=t(['do']),k=t(['on error resume next','exit']),w=t(['rem']);function b(e,t){t.currentIndent++};function o(e,t){t.currentIndent--};function c(e,t){if(e.eatSpace()){return'space'};var i=e.peek();if(i==='\''){e.skipToEnd();return'comment'};if(e.match(w)){e.skipToEnd();return'comment'};if(e.match(/^((&H)|(&O))?[0-9\.]/i,!1)&&!e.match(/^((&H)|(&O))?[0-9\.]+[a-z_]/i,!1)){var n=!1;if(e.match(/^\d*\.\d+/i)){n=!0}
else if(e.match(/^\d+\.\d*/)){n=!0}
else if(e.match(/^\.\d+/)){n=!0};if(n){e.eat(/J/i);return'number'};var r=!1;if(e.match(/^&H[0-9a-f]+/i)){r=!0}
else if(e.match(/^&O[0-7]+/i)){r=!0}
else if(e.match(/^[1-9]\d*F?/)){e.eat(/J/i);r=!0}
else if(e.match(/^0(?![\dx])/i)){r=!0};if(r){e.eat(/L/i);return'number'}};if(e.match(y)){t.tokenize=K(e.current());return t.tokenize(e,t)};if(e.match(C)||e.match(I)||e.match(j)){return'operator'};if(e.match(L)){return null};if(e.match(E)){return'bracket'};if(e.match(k)){t.doInCurrentLine=!0;return'keyword'};if(e.match(x)){b(e,t);t.doInCurrentLine=!0;return'keyword'};if(e.match(g)){if(!t.doInCurrentLine)b(e,t);else t.doInCurrentLine=!1;return'keyword'};if(e.match(u)){return'keyword'};if(e.match(l)){o(e,t);o(e,t);return'keyword'};if(e.match(s)){if(!t.doInCurrentLine)o(e,t);else t.doInCurrentLine=!1;return'keyword'};if(e.match(v)){return'keyword'};if(e.match(f)){return'atom'};if(e.match(h)){return'variable-2'};if(e.match(m)){return'builtin'};if(e.match(p)){return'variable-2'};if(e.match(D)){return'variable'};e.next();return a};function K(e){var n=e.length==1,t='string';return function(i,o){while(!i.eol()){i.eatWhile(/[^'"]/);if(i.match(e)){o.tokenize=c;return t}
else{i.eat(/['"]/)}};if(n){if(r.singleLineStringErrors){return a}
else{o.tokenize=c}};return t}};function U(e,t){var r=t.tokenize(e,t),n=e.current();if(n==='.'){r=t.tokenize(e,t);n=e.current();if(r&&(r.substr(0,8)==='variable'||r==='builtin'||r==='keyword')){if(r==='builtin'||r==='keyword')r='variable';if(i.indexOf(n.substr(1))>-1)r='variable-2';return r}
else{return a}};return r};var d={electricChars:'dDpPtTfFeE ',startState:function(){return{tokenize:c,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:!1,ignoreKeyword:!1}},token:function(e,t){if(e.sol()){t.currentIndent+=t.nextLineIndent;t.nextLineIndent=0;t.doInCurrentLine=0};var r=U(e,t);t.lastToken={style:r,content:e.current()};if(r==='space')r=null;return r},indent:function(t,r){var n=r.replace(/^\s+|\s+$/g,'');if(n.match(s)||n.match(l)||n.match(u))return e.indentUnit*(t.currentIndent-1);if(t.currentIndent<0)return 0;return t.currentIndent*e.indentUnit}};return d});e.defineMIME('text/vbscript','vbscript')});