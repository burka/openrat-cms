(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("tiki",function(e){function i(e,t,n){return function(i,u){while(!i.eol()){if(i.match(t)){u.tokenize=r;break};i.next()};if(n)u.tokenize=n;return e}};function a(e){return function(t,n){while(!t.eol()){t.next()};n.tokenize=r;return e}};function r(e,n){function t(t){n.tokenize=t;return t(e,n)};var o=e.sol(),u=e.next();switch(u){case"{":e.eat("/");e.eatSpace();e.eatWhile(/[^\s\u00a0="'\/?(}]/);n.tokenize=s;return"tag";case"_":if(e.eat("_"))return t(i("strong","__",r));break;case"'":if(e.eat("'"))return t(i("em","''",r));break;case"(":if(e.eat("("))return t(i("variable-2","))",r));break;case"[":return t(i("variable-3","]",r));break;case"|":if(e.eat("|"))return t(i("comment","||"));break;case"-":if(e.eat("=")){return t(i("header string","=-",r))}
else if(e.eat("-")){return t(i("error tw-deleted","--",r))};break;case"=":if(e.match("=="))return t(i("tw-underline","===",r));break;case":":if(e.eat(":"))return t(i("comment","::"));break;case"^":return t(i("tw-box","^"));break;case"~":if(e.match("np~"))return t(i("meta","~/np~"));break};if(o){switch(u){case"!":if(e.match("!!!!!")){return t(a("header string"))}
else if(e.match("!!!!")){return t(a("header string"))}
else if(e.match("!!!")){return t(a("header string"))}
else if(e.match("!!")){return t(a("header string"))}
else{return t(a("header string"))};break;case"*":case"#":case"+":return t(a("tw-listitem bracket"));break}};return null};var m=e.indentUnit,c,f;function s(e,t){var n=e.next(),i=e.peek();if(n=="}"){t.tokenize=r;return"tag"}
else if(n=="("||n==")"){return"bracket"}
else if(n=="="){f="equals";if(i==">"){e.next();i=e.peek()};if(!/['"]/.test(i)){t.tokenize=b()};return"operator"}
else if(/['"]/.test(n)){t.tokenize=p(n);return t.tokenize(e,t)}
else{e.eatWhile(/[^\s\u00a0="'\/?]/);return"keyword"}};function p(e){return function(t,n){while(!t.eol()){if(t.next()==e){n.tokenize=s;break}};return"string"}};function b(){return function(e,t){while(!e.eol()){var n=e.next(),r=e.peek();if(n==" "||n==","||/[ )}]/.test(r)){t.tokenize=s;break}};return"string"}};var t,u;function o(){for(var e=arguments.length-1;e>=0;e--)t.cc.push(arguments[e])};function n(){o.apply(null,arguments);return!0};function d(e,n){var r=t.context&&t.context.noIndent;t.context={prev:t.context,pluginName:e,indent:t.indented,startOfLine:n,noIndent:r}};function k(){if(t.context)t.context=t.context.prev};function h(e){if(e=="openPlugin"){t.pluginName=c;return n(l,x(t.startOfLine))}
else if(e=="closePlugin"){var i=!1;if(t.context){i=t.context.pluginName!=c;k()}
else{i=!0};if(i)u="error";return n(v(i))}
else if(e=="string"){if(!t.context||t.context.name!="!cdata")d("!cdata");if(t.tokenize==r)k();return n()}
else return n()};function x(e){return function(r){if(r=="selfclosePlugin"||r=="endPlugin")return n();if(r=="endPlugin"){d(t.pluginName,e);return n()};return n()}};function v(e){return function(t){if(e)u="error";if(t=="endPlugin")return n();return o()}};function l(e){if(e=="keyword"){u="attribute";return n(l)};if(e=="equals")return n(w,l);return o()};function w(e){if(e=="keyword"){u="string";return n()};if(e=="string")return n(g);return o()};function g(e){if(e=="string")return n(g);else return o()};return{startState:function(){return{tokenize:r,cc:[],indented:0,startOfLine:!0,pluginName:null,context:null}},token:function(e,n){if(e.sol()){n.startOfLine=!0;n.indented=e.indentation()};if(e.eatSpace())return null;u=f=c=null;var r=n.tokenize(e,n);if((r||f)&&r!="comment"){t=n;while(!0){var i=n.cc.pop()||h;if(i(f||r))break}};n.startOfLine=!1;return u||r},indent:function(e,n){var t=e.context;if(t&&t.noIndent)return 0;if(t&&/^{\//.test(n))t=t.prev;while(t&&!t.startOfLine)t=t.prev;if(t)return t.indent+m;else return 0},electricChars:"/"}});e.defineMIME("text/tiki","tiki")});