(function(e){if(typeof exports=='object'&&typeof module=='object')e(require('../../lib/codemirror'));else if(typeof define=='function'&&define.amd)define(['../../lib/codemirror'],e);else e(CodeMirror)})(function(e){'use strict';e.defineMode('velocity',function(){function r(e){var n={},r=e.split(' ');for(var t=0;t<r.length;++t)n[r[t]]=!0;return n};var i=r('#end #else #break #stop #[[ #]] #{end} #{else} #{break} #{stop}'),e=r('#if #elseif #foreach #set #include #parse #macro #define #evaluate #{if} #{elseif} #{foreach} #{set} #{include} #{parse} #{macro} #{define} #{evaluate}'),a=r('$foreach.count $foreach.hasNext $foreach.first $foreach.last $foreach.topmost $foreach.parent.count $foreach.parent.hasNext $foreach.parent.first $foreach.parent.last $foreach.parent $velocityCount $!bodyContent $bodyContent'),o=/[+\-*&%=<>!?:\/|]/;function t(e,t,n){t.tokenize=n;return n(e,t)};function n(r,n){var k=n.beforeParams;n.beforeParams=!1;var f=r.next();if((f=='\'')&&!n.inString&&n.inParams){n.lastTokenWasBuiltin=!1;return t(r,n,l(f))}
else if((f=='"')){n.lastTokenWasBuiltin=!1;if(n.inString){n.inString=!1;return'string'}
else if(n.inParams)return t(r,n,l(f))}
else if(/[\[\]{}\(\),;\.]/.test(f)){if(f=='('&&k)n.inParams=!0;else if(f==')'){n.inParams=!1;n.lastTokenWasBuiltin=!0};return null}
else if(/\d/.test(f)){n.lastTokenWasBuiltin=!1;r.eatWhile(/[\w\.]/);return'number'}
else if(f=='#'&&r.eat('*')){n.lastTokenWasBuiltin=!1;return t(r,n,s)}
else if(f=='#'&&r.match(/ *\[ *\[/)){n.lastTokenWasBuiltin=!1;return t(r,n,u)}
else if(f=='#'&&r.eat('#')){n.lastTokenWasBuiltin=!1;r.skipToEnd();return'comment'}
else if(f=='$'){r.eatWhile(/[\w\d\$_\.{}]/);if(a&&a.propertyIsEnumerable(r.current())){return'keyword'}
else{n.lastTokenWasBuiltin=!0;n.beforeParams=!0;return'builtin'}}
else if(o.test(f)){n.lastTokenWasBuiltin=!1;r.eatWhile(o);return'operator'}
else{r.eatWhile(/[\w\$_{}@]/);var c=r.current();if(i&&i.propertyIsEnumerable(c))return'keyword';if(e&&e.propertyIsEnumerable(c)||(r.current().match(/^#@?[a-z0-9_]+ *$/i)&&r.peek()=='(')&&!(e&&e.propertyIsEnumerable(c.toLowerCase()))){n.beforeParams=!0;n.lastTokenWasBuiltin=!1;return'keyword'};if(n.inString){n.lastTokenWasBuiltin=!1;return'string'};if(r.pos>c.length&&r.string.charAt(r.pos-c.length-1)=='.'&&n.lastTokenWasBuiltin)return'builtin';n.lastTokenWasBuiltin=!1;return null}};function l(e){return function(t,r){var i=!1,a,o=!1;while((a=t.next())!=null){if((a==e)&&!i){o=!0;break};if(e=='"'&&t.peek()=='$'&&!i){r.inString=!0;o=!0;break};i=!i&&a=='\\'};if(o)r.tokenize=n;return'string'}};function s(e,t){var i=!1,r;while(r=e.next()){if(r=='#'&&i){t.tokenize=n;break};i=(r=='*')};return'comment'};function u(e,t){var i=0,r;while(r=e.next()){if(r=='#'&&i==2){t.tokenize=n;break};if(r==']')i++;else if(r!=' ')i=0};return'meta'};return{startState:function(){return{tokenize:n,beforeParams:!1,inParams:!1,inString:!1,lastTokenWasBuiltin:!1}},token:function(e,t){if(e.eatSpace())return null;return t.tokenize(e,t)},blockCommentStart:'#*',blockCommentEnd:'*#',lineComment:'##',fold:'velocity'}});e.defineMIME('text/velocity','velocity')});