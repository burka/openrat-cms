(function(e){if(typeof exports=='object'&&typeof module=='object')e(require('../../lib/codemirror'),require('../htmlmixed/htmlmixed'),require('../../addon/mode/overlay'));else if(typeof define=='function'&&define.amd)define(['../../lib/codemirror','../htmlmixed/htmlmixed','../../addon/mode/overlay'],e);else e(CodeMirror)})(function(e){'use strict';e.defineMode('django:inner',function(){var i=['block','endblock','for','endfor','true','false','filter','endfilter','loop','none','self','super','if','elif','endif','as','else','import','with','endwith','without','context','ifequal','endifequal','ifnotequal','endifnotequal','extends','include','load','comment','endcomment','empty','url','static','trans','blocktrans','endblocktrans','now','regroup','lorem','ifchanged','endifchanged','firstof','debug','cycle','csrf_token','autoescape','endautoescape','spaceless','endspaceless','ssi','templatetag','verbatim','endverbatim','widthratio'],e=['add','addslashes','capfirst','center','cut','date','default','default_if_none','dictsort','dictsortreversed','divisibleby','escape','escapejs','filesizeformat','first','floatformat','force_escape','get_digit','iriencode','join','last','length','length_is','linebreaks','linebreaksbr','linenumbers','ljust','lower','make_list','phone2numeric','pluralize','pprint','random','removetags','rjust','safe','safeseq','slice','slugify','stringformat','striptags','time','timesince','timeuntil','title','truncatechars','truncatechars_html','truncatewords','truncatewords_html','unordered_list','upper','urlencode','urlize','urlizetrunc','wordcount','wordwrap','yesno'],n=['==','!=','<','>','<=','>='],o=['in','not','or','and'];i=new RegExp('^\\b('+i.join('|')+')\\b');e=new RegExp('^\\b('+e.join('|')+')\\b');n=new RegExp('^\\b('+n.join('|')+')\\b');o=new RegExp('^\\b('+o.join('|')+')\\b');function t(e,t){if(e.match('{{')){t.tokenize=l;return'tag'}
else if(e.match('{%')){t.tokenize=a;return'tag'}
else if(e.match('{#')){t.tokenize=u;return'comment'}
while(e.next()!=null&&!e.match(/\{[{%#]/,!1)){};return null};function r(e,t){return function(r,i){if(!i.escapeNext&&r.eat(e)){i.tokenize=t}
else{if(i.escapeNext){i.escapeNext=!1};var n=r.next();if(n=='\\'){i.escapeNext=!0}};return'string'}};function l(n,i){if(i.waitDot){i.waitDot=!1;if(n.peek()!='.'){return'null'};if(n.match(/\.\W+/)){return'error'}
else if(n.eat('.')){i.waitProperty=!0;return'null'}
else{throw Error('Unexpected error while waiting for property.')}};if(i.waitPipe){i.waitPipe=!1;if(n.peek()!='|'){return'null'};if(n.match(/\.\W+/)){return'error'}
else if(n.eat('|')){i.waitFilter=!0;return'null'}
else{throw Error('Unexpected error while waiting for filter.')}};if(i.waitProperty){i.waitProperty=!1;if(n.match(/\b(\w+)\b/)){i.waitDot=!0;i.waitPipe=!0;return'property'}};if(i.waitFilter){i.waitFilter=!1;if(n.match(e)){return'variable-2'}};if(n.eatSpace()){i.waitProperty=!1;return'null'};if(n.match(/\b\d+(\.\d+)?\b/)){return'number'};if(n.match('\'')){i.tokenize=r('\'',i.tokenize);return'string'}
else if(n.match('"')){i.tokenize=r('"',i.tokenize);return'string'};if(n.match(/\b(\w+)\b/)&&!i.foundVariable){i.waitDot=!0;i.waitPipe=!0;return'variable'};if(n.match('}}')){i.waitProperty=null;i.waitFilter=null;i.waitDot=null;i.waitPipe=null;i.tokenize=t;return'tag'};n.next();return'null'};function a(l,a){if(a.waitDot){a.waitDot=!1;if(l.peek()!='.'){return'null'};if(l.match(/\.\W+/)){return'error'}
else if(l.eat('.')){a.waitProperty=!0;return'null'}
else{throw Error('Unexpected error while waiting for property.')}};if(a.waitPipe){a.waitPipe=!1;if(l.peek()!='|'){return'null'};if(l.match(/\.\W+/)){return'error'}
else if(l.eat('|')){a.waitFilter=!0;return'null'}
else{throw Error('Unexpected error while waiting for filter.')}};if(a.waitProperty){a.waitProperty=!1;if(l.match(/\b(\w+)\b/)){a.waitDot=!0;a.waitPipe=!0;return'property'}};if(a.waitFilter){a.waitFilter=!1;if(l.match(e)){return'variable-2'}};if(l.eatSpace()){a.waitProperty=!1;return'null'};if(l.match(/\b\d+(\.\d+)?\b/)){return'number'};if(l.match('\'')){a.tokenize=r('\'',a.tokenize);return'string'}
else if(l.match('"')){a.tokenize=r('"',a.tokenize);return'string'};if(l.match(n)){return'operator'};if(l.match(o)){return'keyword'};var u=l.match(i);if(u){if(u[0]=='comment'){a.blockCommentTag=!0};return'keyword'};if(l.match(/\b(\w+)\b/)){a.waitDot=!0;a.waitPipe=!0;return'variable'};if(l.match('%}')){a.waitProperty=null;a.waitFilter=null;a.waitDot=null;a.waitPipe=null;if(a.blockCommentTag){a.blockCommentTag=!1;a.tokenize=f}
else{a.tokenize=t};return'tag'};l.next();return'null'};function u(e,r){if(e.match(/^.*?#\}/))r.tokenize=t;else e.skipToEnd();return'comment'};function f(e,t){if(e.match(/\{%\s*endcomment\s*%\}/,!1)){t.tokenize=a;e.match('{%');return'tag'}
else{e.next();return'comment'}};return{startState:function(){return{tokenize:t}},token:function(e,t){return t.tokenize(e,t)},blockCommentStart:'{% comment %}',blockCommentEnd:'{% endcomment %}'}});e.defineMode('django',function(t){var r=e.getMode(t,'text/html'),i=e.getMode(t,'django:inner');return e.overlayMode(r,i)});e.defineMIME('text/x-django','django')});