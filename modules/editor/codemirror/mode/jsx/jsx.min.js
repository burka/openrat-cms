(function(t){if(typeof exports=='object'&&typeof module=='object')t(require('../../lib/codemirror'),require('../xml/xml'),require('../javascript/javascript'));else if(typeof define=='function'&&define.amd)define(['../../lib/codemirror','../xml/xml','../javascript/javascript'],t);else t(CodeMirror)})(function(t){'use strict';function e(t,e,n,i){this.state=t;this.mode=e;this.depth=n;this.prev=i};function n(i){return new e(t.copyState(i.mode,i.state),i.mode,i.depth,i.prev&&n(i.prev))};t.defineMode('jsx',function(i,s){var r=t.getMode(i,{name:'xml',allowMissing:!0,multilineTagIndentPastTag:!1});var a=t.getMode(i,s&&s.base||'javascript');function o(t){var n=t.tagName;t.tagName=null;var e=r.indent(t,'');t.tagName=n;return e};function c(t,e){if(e.context.mode==r)return f(t,e,e.context);else return p(t,e,e.context)};function f(n,f,s){if(s.depth==2){if(n.match(/^.*?\*\//))s.depth=1;else n.skipToEnd();return'comment'};if(n.peek()=='{'){r.skipAttribute(s.state);var d=o(s.state),p=s.state.context;if(p&&n.match(/^[^>]*>\s*$/,!1)){while(p.prev&&!p.startOfLine)p=p.prev;if(p.startOfLine)d-=i.indentUnit;else if(s.prev.state.lexical)d=s.prev.state.lexical.indented}
else if(s.depth==1){d+=i.indentUnit};f.context=new e(t.startState(a,d),a,0,f.context);return null};if(s.depth==1){if(n.peek()=='<'){r.skipAttribute(s.state);f.context=new e(t.startState(r,o(s.state)),r,0,f.context);return null}
else if(n.match('//')){n.skipToEnd();return'comment'}
else if(n.match('/*')){s.depth=2;return c(n,f)}};var l=r.token(n,s.state),u=n.current(),x;if(/\btag\b/.test(l)){if(/>$/.test(u)){if(s.state.context)s.depth=0;else f.context=f.context.prev}
else if(/^</.test(u)){s.depth=1}}
else if(!l&&(x=u.indexOf('{'))>-1){n.backUp(u.length-x)};return l};function p(n,s,i){if(n.peek()=='<'&&a.expressionAllowed(n,i.state)){a.skipExpression(i.state);s.context=new e(t.startState(r,a.indent(i.state,'')),r,0,s.context);return null};var c=a.token(n,i.state);if(!c&&i.depth!=null){var o=n.current();if(o=='{'){i.depth++}
else if(o=='}'){if(--i.depth==0)s.context=s.context.prev}};return c};return{startState:function(){return{context:new e(t.startState(a),a)}},copyState:function(t){return{context:n(t.context)}},token:c,indent:function(t,e,n){return t.context.mode.indent(t.context.state,e,n)},innerMode:function(t){return t.context}}},'xml','javascript');t.defineMIME('text/jsx','jsx');t.defineMIME('text/typescript-jsx',{name:'jsx',base:{name:'javascript',typescript:!0}})});